<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sudoku Solver</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }
        textarea {
            width: 300px;
            height: 300px;
            font-family: monospace;
            font-size: 16px;
            margin-bottom: 10px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
        }
        .error {
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Sudoku Solver</h1>
    <textarea id="sudokuInput" placeholder="Voer je sudoku in het juiste formaat in..."></textarea><br>
    <button onclick="solveSudoku()">Los op</button>
    <button onclick="copyToClipboard()" style="display: none;" id="copyButton">Kopieer oplossing</button>
    <p id="message" class="error"></p>
    <textarea id="sudokuOutput" readonly style="display: none;"></textarea>

    <script>
        function parseSudoku(input) {
            const rows = input.trim().split('\n').filter(row => !row.startsWith('+'));
            if (rows.length !== 9) return null;
            const grid = rows.map(row => {
                const values = row.split('|').join('').trim().split(' ').filter(cell => cell !== '');
                return values.map(val => (val === '.' ? 0 : parseInt(val)));
            });
            return grid.every(row => row.length === 9) ? grid : null;
        }

        function formatSudoku(grid) {
            if (!grid) return null;
            let output = '+-----+-----+-----+\n';
            grid.forEach((row, rowIndex) => {
                output += '|';
                row.forEach((cell, colIndex) => {
                    output += (cell === 0 ? '.' : cell) + ' ';
                    if ((colIndex + 1) % 3 === 0) output += '|';
                });
                output = output.trim() + '\n';
                if ((rowIndex + 1) % 3 === 0) output += '+-----+-----+-----+\n';
            });
            return output.trim();
        }

        function isValid(grid, row, col, num) {
            for (let i = 0; i < 9; i++) {
                if (grid[row][i] === num || grid[i][col] === num ||
                    grid[Math.floor(row / 3) * 3 + Math.floor(i / 3)][Math.floor(col / 3) * 3 + (i % 3)] === num) {
                    return false;
                }
            }
            return true;
        }

        function solve(grid) {
            for (let row = 0; row < 9; row++) {
                for (let col = 0; col < 9; col++) {
                    if (grid[row][col] === 0) {
                        for (let num = 1; num <= 9; num++) {
                            if (isValid(grid, row, col, num)) {
                                grid[row][col] = num;
                                if (solve(grid)) return true;
                                grid[row][col] = 0;
                            }
                        }
                        return false;
                    }
                }
            }
            return true;
        }

        function solveSudoku() {
            const input = document.getElementById('sudokuInput').value;
            const parsedGrid = parseSudoku(input);
            const messageEl = document.getElementById('message');
            const outputEl = document.getElementById('sudokuOutput');
            const copyButton = document.getElementById('copyButton');

            if (!parsedGrid) {
                messageEl.textContent = "Ongeldig formaat. Controleer je invoer.";
                outputEl.style.display = 'none';
                copyButton.style.display = 'none';
                return;
            }

            const solvedGrid = JSON.parse(JSON.stringify(parsedGrid));
            if (solve(solvedGrid)) {
                const formattedSolution = formatSudoku(solvedGrid);
                messageEl.textContent = '';
                outputEl.value = formattedSolution;
                outputEl.style.display = 'block';
                copyButton.style.display = 'block';
            } else {
                messageEl.textContent = "De sudoku is niet oplosbaar.";
                outputEl.style.display = 'none';
                copyButton.style.display = 'none';
            }
        }

        function copyToClipboard() {
            const outputEl = document.getElementById('sudokuOutput');
            outputEl.select();
            document.execCommand('copy');
            alert("Oplossing gekopieerd naar het klembord!");
        }
    </script>
</body>
</html>
